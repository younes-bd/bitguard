{% extends "base.html" %}
{% load static %}

{% block content %}
<link rel="stylesheet" href="{% static 'accounts/css/accounts.css' %}?v=6">

<section class="bg-bitguard-light-blue hero-section tw-min-h-screen tw-p-8 tw-pt-24">

    <!-- Glow Effect -->
    <div class="purple-bg-grad reveal-up hero-glow-effect"></div>

    <div class="tw-relative tw-z-10 tw-container tw-mx-auto">

        <!-- Blog Header (Custom for Blog) -->
        <div class="tw-text-center tw-mb-12">
            <h1 class="tw-text-4xl tw-md:text-5xl bitguard-heading tw-mb-4 tw-tracking-tight">
                {% block blog_title %}BitGuard Blog{% endblock %}
            </h1>
            <p class="tw-text-slate-500 tw-text-lg tw-max-w-2xl tw-mx-auto">
                {% block blog_subtitle %}Insights, updates, and resources for your cybersecurity journey.{% endblock %}
            </p>
        </div>

        <div class="bitguard-layout">

            <!-- Main Content Area (Left/Top) -->
            <div class="bitguard-content-col">
                <div class="bitguard-card tw-p-8 tw-relative tw-overflow-hidden tw-min-h-[500px]">
                    <!-- Gradient Enhancement -->
                    <div class="bitguard-gradient-bg"></div>
                    <div class="tw-relative tw-z-10">
                        {% if messages %}
                        <div class="tw-mb-8">
                            {% for message in messages %}
                            <div
                                class="tw-p-4 tw-rounded-xl tw-bg-cyan-500/10 tw-border tw-border-cyan-500/20 tw-text-cyan-600 tw-mb-2">
                                {{ message }}
                            </div>
                            {% endfor %}
                        </div>
                        {% endif %}

                        {% block blog_content %}
                        {% endblock %}
                    </div>
                </div>
            </div>

            <!-- Sidebar (Right/Bottom) - Using bitguard-sidebar-col but placed after content for right alignment in row mode if we change css, or just standard sidebar items -->
            <!-- Note: bitguard-layout is flex (row on desktop). Left is first child. If we want Right sidebar, we should swap order or CSS order. 
                 Accounts theme usually has Left sidebar. Let's try sticking to Left Sidebar for consistency with Accounts Dashboard? 
                 Or simply put it second and let it be on the right if flex-direction is row. 
                 Wait, accounts.css: .bitguard-layout { flex-direction: column; } @media(min-width:768px){ flex-direction: row; }
                 So first child is Left. 
                 For a blog, Right sidebar is common. I'll put Sidebar SECOND in HTML. It will appear on Right. 
            -->
            <div class="bitguard-sidebar-col">
                <div class="tw-space-y-6">

                    <!-- Search Widget -->
                    <div class="bitguard-card tw-p-6">
                        <h3 class="bitguard-label tw-flex tw-items-center tw-gap-2 tw-mb-4">
                            <i class="fas fa-search tw-text-cyan-600"></i> Search
                        </h3>
                        <form action="{% url 'blog:search' %}" method="get" class="tw-relative">
                            <input type="text" name="q" placeholder="Search posts..." class="bitguard-input">
                            <button type="submit"
                                class="tw-absolute tw-right-3 tw-top-2.5 tw-text-slate-400 hover:tw-text-cyan-600">
                                <i class="fas fa-arrow-right"></i>
                            </button>
                        </form>
                    </div>

                    <!-- Categories Widget -->
                    <div class="bitguard-card tw-p-6">
                        <h3 class="bitguard-label tw-flex tw-items-center tw-gap-2 tw-mb-4">
                            <i class="fas fa-folder tw-text-cyan-600"></i> Categories
                        </h3>
                        <ul class="tw-space-y-2">
                            {% for cat in categories %}
                            <li>
                                <a href="{% url 'blog:category_post' cat.slug %}"
                                    class="tw-flex tw-items-center tw-justify-between tw-text-slate-500 hover:tw-text-cyan-700 tw-group tw-transition-colors">
                                    <span class="tw-text-sm tw-font-medium">{{ cat.name }}</span>
                                    <span
                                        class="tw-text-xs tw-bg-slate-100 tw-text-slate-500 tw-px-2 tw-py-0.5 tw-rounded-full group-hover:tw-bg-cyan-100 group-hover:tw-text-cyan-700 tw-transition-colors">
                                        {{ cat.posts.count }}
                                    </span>
                                </a>
                            </li>
                            {% empty %}
                            <li class="tw-text-slate-400 tw-text-sm">No categories yet.</li>
                            {% endfor %}
                        </ul>
                    </div>

                    <!-- Dashboard Link (If Staff) -->
                    {% if user.is_staff %}
                    <div class="bitguard-card tw-p-6">
                        <h3 class="bitguard-label tw-mb-4">Admin Controls</h3>
                        <a href="{% url 'blog:dashboard' %}"
                            class="btn-bitguard tw-w-full tw-block tw-text-center tw-no-underline">
                            Manage Blog
                        </a>
                    </div>
                    {% endif %}

                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
