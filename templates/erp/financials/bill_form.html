{% extends 'erp/base.html' %}
{% load static %}

{% block page_title %}{% if object %}Edit Bill{% else %}Upload Bill{% endif %}{% endblock %}

{% block erp_content %}
<div>
    <div style="display: flex; justify-content: center;">
        <div class="card" style="width: 100%; max-width: 700px; padding: 32px;">
            <div class="flex-between mb-6" style="padding-bottom: 16px; border-bottom: 1px solid var(--border-color);">
                <div>
                    <h2 class="text-xl font-bold text-dark">{% if object %}Edit Bill{% else %}Upload Vendor Bill{% endif %}</h2>
                    <p class="text-sm text-gray mt-1">Record incoming invoices from vendors.</p>
                </div>
                <a href="{% url 'erp_bill_list' %}" class="btn-text"
                    style="color: var(--text-secondary); text-decoration: none; display: flex; align-items: center; gap: 6px;">
                    <i class="fas fa-times"></i> Cancel
                </a>
            </div>

            <form method="post" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Vendor & Ref -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                    <div class="form-group">
                        <label class="form-label">Vendor</label>
                        <div class="custom-select-wrapper">{{ form.vendor }}</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Reference #</label>
                        {{ form.reference_number }}
                    </div>

                    <div class="form-group">
                        <label class="form-label">Amount ($)</label>
                        {{ form.amount }}
                    </div>

                    <div class="form-group">
                        <label class="form-label">Due Date</label>
                        <input type="date" name="due_date" value="{{ form.due_date.value|date:'Y-m-d' }}"
                            class="form-control">
                    </div>
                </div>

                <!-- Attachment -->
                <div style="padding-top: 24px; border-top: 1px solid var(--border-color); margin-bottom: 24px;">
                    <label class="form-label mb-2">Invoice Document</label>
                    <div style="border: 2px dashed var(--border-color); border-radius: 8px; padding: 24px; text-align: center; cursor: pointer; transition: background 0.2s;"
                        onmouseover="this.style.background='var(--bg-body)'"
                        onmouseout="this.style.background='transparent'">
                        <i class="fas fa-file-pdf text-3xl mb-2" style="color: #f87171;"></i>
                        <p class="text-sm text-dark font-medium">Upload Invoice PDF</p>
                        <div style="display: none;">{{ form.document }}</div>
                    </div>
                </div>

                <!-- Status -->
                <div style="padding-top: 24px; border-top: 1px solid var(--border-color);">
                    <div class="form-group">
                        <label class="form-label">Status</label>
                        <div class="custom-select-wrapper">{{ form.status }}</div>
                    </div>
                </div>

                <!-- Footer -->
                <div class="flex-center gap-3"
                    style="justify-content: flex-end; padding-top: 24px; border-top: 1px solid var(--border-color); margin-top: 32px;">
                    <a href="{% url 'erp_bill_list' %}" class="btn-secondary">Discard</a>
                    <button type="submit" class="btn-primary" style="padding-left: 32px; padding-right: 32px;">Save
                        Bill</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const inputs = document.querySelectorAll('input, select, textarea');
        inputs.forEach(input => {
            if (!input.classList.contains('form-control') && input.type !== 'file') {
                input.classList.add('form-control');
            }
            if (input.tagName === 'SELECT' || input.tagName === 'INPUT') {
                input.style.width = '100%';
            }
        });
        const selects = document.querySelectorAll('select');
        selects.forEach(sel => {
            sel.style.height = '42px';
            sel.style.border = '1px solid var(--border-color)';
            sel.style.borderRadius = '6px';
            sel.style.padding = '0 12px';
        });
    });
</script>
{% endblock %}