{% extends 'crm/base_crm.html' %}
{% load static %}

{% block dashboard_content %}
<div style="margin-bottom: 20px;">
    <a href="{% url 'crm_tickets' %}"
        style="color: #6b7280; text-decoration: none; font-size: 13px; display: inline-flex; align-items: center; gap: 5px;">
        <i class="fas fa-arrow-left"></i> Back to Tickets
    </a>
</div>

<div class="flex-between mb-4">
    <div>
        <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 5px;">
            <span style="font-size: 18px; font-weight: bold; color: #6b7280;">#{{ ticket.id }}</span>
            <span class="badge {% if ticket.status == 'open' %}badge-high{% else %}badge-low{% endif %}">{{
                ticket.get_status_display }}</span>
        </div>
        <h1 class="text-2xl">{{ ticket.summary }}</h1>
    </div>

    <div style="display: flex; gap: 10px;">
        <a href="{% url 'admin:crm_ticket_change' ticket.id %}" target="_blank"
            style="background-color: white; border: 1px solid #e5e7eb; color: #374151; padding: 8px 16px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 13px;">
            Action...
        </a>
    </div>
</div>

<div class="grid-cols-3">
    <!-- Left: Ticket Info -->
    <div class="card">
        <h3 class="text-lg mb-4">Details</h3>
        <div style="display: flex; flex-direction: column; gap: 15px;">
            <div>
                <label
                    style="display: block; font-size: 11px; text-transform: uppercase; color: #9ca3af; font-weight: 600; margin-bottom: 4px;">Client</label>
                <a href="{% url 'crm_client_detail' ticket.client.id %}"
                    style="color: #0ea5e9; text-decoration: none; font-weight: 600;">
                    {{ ticket.client.name }}
                </a>
            </div>

            <div>
                <label
                    style="display: block; font-size: 11px; text-transform: uppercase; color: #9ca3af; font-weight: 600; margin-bottom: 4px;">Priority</label>
                <span style="font-weight: 600;">{{ ticket.get_priority_display }}</span>
            </div>

            <div>
                <label
                    style="display: block; font-size: 11px; text-transform: uppercase; color: #9ca3af; font-weight: 600; margin-bottom: 4px;">Assigned
                    To</label>
                {% if ticket.assigned_to %}
                <span>{{ ticket.assigned_to.username }}</span>
                {% else %}
                <span style="color: #9ca3af;">Unassigned</span>
                {% endif %}
            </div>

            <div>
                <label
                    style="display: block; font-size: 11px; text-transform: uppercase; color: #9ca3af; font-weight: 600; margin-bottom: 4px;">Created</label>
                <span style="font-size: 13px;">{{ ticket.created_at }}</span>
            </div>
        </div>
    </div>

    <!-- Right: Conversation -->
    <div class="col-span-2">
        <div class="card">
            <h3 class="text-lg mb-4">Description</h3>
            <div
                style="background-color: #f9fafb; padding: 20px; border-radius: 8px; border: 1px solid #f3f4f6; margin-bottom: 20px;">
                <p style="white-space: pre-wrap;">{{ ticket.description }}</p>
            </div>

            <h3 class="text-lg mb-4">Activity / Comments</h3>
            <div
                style="text-align: center; padding: 30px; border: 1px dashed #e5e7eb; border-radius: 8px; color: #9ca3af;">
                <p>No comments yet. (Comment functionality to be implemented)</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}